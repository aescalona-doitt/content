category: Endpoint
commonfields:
  id: Windows Defender Advanced Threat Protection-test
  version: -1
configuration:
- defaultvalue: https://api.securitycenter.windows.com
  display: Host URL (e.g. https://api.securitycenter.windows.com)
  name: url
  required: true
  type: 0
- display: ID (received from the admin consent - see Detailed Instructions (?)
  name: auth_id
  required: true
  type: 4
- display: Token (received from the admin consent - see Detailed Instructions (?)
    section)
  name: tenant_id
  required: true
  type: 4
- display: Key (received from the admin consent - see Detailed Instructions (?)
  name: enc_key
  required: true
  type: 4
- display: Fetch incidents
  name: isFetch
  required: false
  type: 8
- display: Incident type
  name: incidentType
  required: false
  type: 13
- defaultvalue: New
  display: 'Status to filter out alerts for fetching as incidents. The property values
    are: New,InProgress,Resolved (Comma separated values supported, e.g. New,Resolved)'
  name: fetch_status
  required: false
  type: 0
- defaultvalue: Informational,Low,Medium,High
  display: 'Severity to filter out alerts for fetching as incidents. The property
    values are: Informational,Low,Medium,High (Comma separated values supported, e.g.
    Medium,High)'
  name: fetch_severity
  required: false
  type: 0
- display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
description: Windows Defender Advanced Threat Protection (ATP) is a unified platform
  for preventative protection, post-breach detection, automated investigation, and
  response.
display: Windows Defender Advanced Threat Protection-test
name: Windows Defender Advanced Threat Protection-test
script:
  commands:
  - arguments:
    - default: true
      description: Machine ID to be used for isolation. e.g. 0a3250e0693a109f1affc9217be9459028aa8426
      isArray: false
      name: machine_id
      required: true
      secret: false
    - default: false
      description: Comment to associate with the action.
      isArray: false
      name: comment
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: Full isolation or selective isolation (Restrict only limited set
        of applications from accessing the network)
      isArray: false
      name: isolation_type
      predefined:
      - Full
      - Selective
      required: true
      secret: false
    deprecated: false
    description: Isolates a machine from accessing external network.
    execution: true
    name: microsoft-atp-isolate-machine
    outputs:
    - contextPath: MicrosoftATP.Machine.Isolation.Requestor
      description: Machine isolation requestor
      type: string
    - contextPath: MicrosoftATP.Machine.Isolation.RequestorComment
      description: Machine isolation requestor comment
      type: string
    - contextPath: MicrosoftATP.Machine.ID
      description: Machine ID
      type: string
    - contextPath: MicrosoftATP.Machine.Isolation.Isolated
      description: True if machine is isolated, else false
      type: boolean
  - arguments:
    - default: false
      description: Machine ID to be used to stop the isolation. e.g. 0a3250e0693a109f1affc9217be9459028aa8426
      isArray: false
      name: machine_id
      required: true
      secret: false
    - default: false
      description: Comment to associate with the action.
      isArray: false
      name: comment
      required: true
      secret: false
    deprecated: false
    description: Undo an isolation of a machine
    execution: false
    name: microsoft-atp-unisolate-machine
    outputs:
    - contextPath: MicrosoftATP.Machine.Isolation.Requestor
      description: Machine un-isolation requestor
      type: string
    - contextPath: MicrosoftATP.Machine.Isolation.RequestorComment
      description: Machine un-isolation requestor comment
      type: string
    - contextPath: MicrosoftATP.Machine.ID
      description: Machine ID
      type: Unknown
  - arguments:
    - default: false
      description: Computer DNS name
      isArray: false
      name: hostname
      required: false
      secret: false
    - default: false
      description: Machine last external IP address
      isArray: false
      name: ip
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Machine risk score
      isArray: false
      name: risk_score
      predefined:
      - Low
      - Medium
      - High
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Machine health status
      isArray: false
      name: health_status
      predefined:
      - Active
      - Inactive
      required: false
      secret: false
    deprecated: false
    description: Retrieves a collection of machines that have communicated with WDATP
      cloud on the last 30 days
    execution: false
    name: microsoft-atp-get-machines
    outputs:
    - contextPath: MicrosoftATP.Machine.ID
      description: Machine ID
      type: string
    - contextPath: MicrosoftATP.Machine.ComputerDNSName
      description: Machine DNS name
      type: string
    - contextPath: MicrosoftATP.Machine.AgentVersion
      description: Machine agent version
      type: string
    - contextPath: MicrosoftATP.Machine.FirstSeen
      description: Machine first seen date
      type: date
    - contextPath: MicrosoftATP.Machine.LastSeen
      description: Machine last seen date
      type: string
    - contextPath: MicrosoftATP.Machine.HealthStatus
      description: Machine health status
      type: string
    - contextPath: MicrosoftATP.Machine.IsAADJoined
      description: True if machine is AAD joined, else false
      type: boolean
    - contextPath: MicrosoftATP.Machine.LastExternalIPAddress
      description: Machine last external IP address
      type: string
    - contextPath: MicrosoftATP.Machine.LastIPAddress
      description: Machine last IP address
      type: string
    - contextPath: MicrosoftATP.Machine.Tags
      description: Machine tags
      type: string
    - contextPath: MicrosoftATP.Machine.OSBuild
      description: Machine OS build
      type: number
    - contextPath: MicrosoftATP.Machine.OSPlatform
      description: Machine OS platform
      type: string
    - contextPath: MicrosoftATP.Machine.RBACGroupID
      description: Machine RBAC group ID
      type: string
    - contextPath: MicrosoftATP.Machine.RiskScore
      description: Machine risk score
      type: string
    - contextPath: MicrosoftATP.Machine.RBACGroupName
      description: Machine RBAC group name
      type: string
    - contextPath: MicrosoftATP.Machine.AADDeviceID
      description: Machine AAD device ID
      type: string
    - contextPath: MicrosoftATP.Machine.OSVersion
      description: Machine OS version
      type: string
    - contextPath: Endpoint.Hostname
      description: Machine DNS name
      type: string
    - contextPath: Endpoint.IPAddress
      description: Machine last IP address
      type: string
    - contextPath: Endpoint.OS
      description: Machine OS platform
      type: string
    - contextPath: Endpoint.OSVersion
      description: Machine OS version
      type: string
  - arguments:
    - default: false
      description: File hash to get machines related to
      isArray: false
      name: file
      required: true
      secret: false
    deprecated: false
    description: Get a collection of machines related to a given file hash.
    execution: false
    name: microsoft-atp-get-file-related-machines
    outputs:
    - contextPath: MicrosoftATP.Machine.ID
      description: Machine ID
      type: string
    - contextPath: MicrosoftATP.Machine.ComputerDNSName
      description: Machine DNS name
      type: string
    - contextPath: MicrosoftATP.Machine.AgentVersion
      description: Machine agent version
      type: string
    - contextPath: MicrosoftATP.Machine.FirstSeen
      description: Machine first seen date
      type: date
    - contextPath: MicrosoftATP.Machine.LastSeen
      description: Machine last seen date
      type: string
    - contextPath: MicrosoftATP.Machine.HelathStatus
      description: Machine health status
      type: string
    - contextPath: MicrosoftATP.Machine.IsAADJoined
      description: True if machine is AAD joined, else false
      type: boolean
    - contextPath: MicrosoftATP.Machine.LastExternalIPAddress
      description: Machine last external IP address
      type: string
    - contextPath: MicrosoftATP.Machine.LastIPAddress
      description: Machine last IP address
      type: string
    - contextPath: MicrosoftATP.Machine.Tags
      description: Machine tags
      type: string
    - contextPath: MicrosoftATP.Machine.OSBuild
      description: Machine OS build
      type: number
    - contextPath: MicrosoftATP.Machine.OSPlatform
      description: Machine OS platform
      type: string
    - contextPath: MicrosoftATP.Machine.RBACGroupID
      description: Machine RBAC group ID
      type: string
    - contextPath: MicrosoftATP.Machine.RiskScore
      description: Machine risk score
      type: string
    - contextPath: MicrosoftATP.Machine.RBACGroupName
      description: Machine RBAC group name
      type: string
    - contextPath: MicrosoftATP.Machine.AADDeviceID
      description: Machine AAD device ID
      type: string
    - contextPath: MicrosoftATP.Machine.OSVersion
      description: Machine OS version
      type: string
    - contextPath: Endpoint.Hostname
      description: Machine DNS name
      type: string
    - contextPath: Endpoint.IPAddress
      description: Machine last IP address
      type: string
    - contextPath: Endpoint.OS
      description: Machine OS platform
      type: string
    - contextPath: Endpoint.OSVersion
      description: Machine OS version
      type: string
    - contextPath: MicrosoftATP.Machine.RelatedFile
      description: Machine related file hash
      type: string
  - arguments:
    - default: true
      description: Machine id to be used for getting the machine details, e.g. 0a3250e0693a109f1affc9217be9459028aa8426
      isArray: false
      name: machine_id
      required: true
      secret: false
    deprecated: false
    description: Get a machine details by its identity.
    execution: false
    name: microsoft-atp-get-machine-details
    outputs:
    - contextPath: MicrosoftATP.Machine.ID
      description: Machine ID
      type: string
    - contextPath: MicrosoftATP.Machine.ComputerDNSName
      description: Machine DNS name
      type: string
    - contextPath: MicrosoftATP.Machine.AgentVersion
      description: Machine agent version
      type: string
    - contextPath: MicrosoftATP.Machine.FirstSeen
      description: Machine first seen date
      type: date
    - contextPath: MicrosoftATP.Machine.LastSeen
      description: Machine last seen date
      type: string
    - contextPath: MicrosoftATP.Machine.HelathStatus
      description: Machine health status
      type: string
    - contextPath: MicrosoftATP.Machine.IsAADJoined
      description: True if machine is AAD joined, else false
      type: boolean
    - contextPath: MicrosoftATP.Machine.LastExternalIPAddress
      description: Machine last external IP address
      type: string
    - contextPath: MicrosoftATP.Machine.LastIPAddress
      description: Machine last IP address
      type: string
    - contextPath: MicrosoftATP.Machine.Tags
      description: Machine tags
      type: string
    - contextPath: MicrosoftATP.Machine.OSBuild
      description: Machine OS build
      type: number
    - contextPath: MicrosoftATP.Machine.OSPlatform
      description: Machine OS platform
      type: string
    - contextPath: MicrosoftATP.Machine.RBACGroupID
      description: Machine RBAC group ID
      type: string
    - contextPath: MicrosoftATP.Machine.RiskScore
      description: Machine risk score
      type: string
    - contextPath: MicrosoftATP.Machine.RBACGroupName
      description: Machine RBAC group name
      type: string
    - contextPath: MicrosoftATP.Machine.AADDeviceID
      description: Machine AAD device ID
      type: string
    - contextPath: MicrosoftATP.Machine.OSVersion
      description: Machine OS version
      type: string
    - contextPath: Endpoint.Hostname
      description: Machine DNS name
      type: string
    - contextPath: Endpoint.IPAddress
      description: Machine last IP address
      type: string
    - contextPath: Endpoint.OS
      description: Machine OS platform
      type: string
    - contextPath: Endpoint.OSVersion
      description: Machine OS version
      type: string
  - arguments:
    - default: false
      description: Machine ID to run the scan on
      isArray: false
      name: machine_id
      required: true
      secret: false
    - default: false
      description: Comment to associate with the action
      isArray: false
      name: comment
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: Defines the type of the scan
      isArray: false
      name: scan_type
      predefined:
      - Quick
      - Full
      required: true
      secret: false
    deprecated: false
    description: Initiate Windows Defender Antivirus scan on a machine
    execution: false
    name: microsoft-atp-run-antivirus-scan
  - arguments:
    - auto: PREDEFINED
      default: false
      description: Alert severity
      isArray: false
      name: severity
      predefined:
      - High
      - Medium
      - Low
      - Informational
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Alert status
      isArray: false
      name: status
      predefined:
      - New
      - InProgress
      - Resolved
      required: false
      secret: false
    deprecated: false
    description: Get a list of alerts present on the system.
    execution: false
    name: microsoft-atp-list-alerts
    outputs:
    - contextPath: MicrosoftATP.Alert.DetectionSource
      description: Alert detection source
      type: string
    - contextPath: MicrosoftATP.Alert.MachineID
      description: Alert machine ID
      type: string
    - contextPath: MicrosoftATP.Alert.Classification
      description: Alert classification
      type: string
    - contextPath: MicrosoftATP.Alert.AlertCreationTime
      description: Alert creation time
      type: date
    - contextPath: MicrosoftATP.Alert.RecommendedAction
      description: Alert recommended action
      type: string
    - contextPath: MicrosoftATP.Alert.LastEventTime
      description: Alert last event time
      type: date
    - contextPath: MicrosoftATP.Alert.Status
      description: Alert status
      type: string
    - contextPath: MicrosoftATP.Alert.FirstEventTime
      description: Alert first event time
      type: string
    - contextPath: MicrosoftATP.Alert.Title
      description: Alert title
      type: string
    - contextPath: MicrosoftATP.Alert.ID
      description: Alert ID
      type: string
    - contextPath: MicrosoftATP.Alert.Description
      description: Alert description
      type: string
    - contextPath: MicrosoftATP.Alert.Severity
      description: Alert severity
      type: string
    - contextPath: MicrosoftATP.Alert.Category
      description: Alert category
      type: string
  - arguments:
    - default: false
      description: Alert ID to update
      isArray: false
      name: alert_id
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: Alert status to update
      isArray: false
      name: status
      predefined:
      - New
      - InProgress
      - Resolved
      required: false
      secret: false
    - default: false
      description: Owner of the alert
      isArray: false
      name: assigned_to
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Specifies the specification of the alert
      isArray: false
      name: classification
      predefined:
      - Unknown
      - FalsePositive
      - TruePositive
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: Specifies the determination of the alert
      isArray: false
      name: determination
      predefined:
      - NotAvailable
      - Apt
      - Malware
      - SecurityPersonnel
      - SecurityTesting
      - UnwantedSoftware
      - Other
      required: false
      secret: false
    deprecated: false
    description: Update the properties of an alert entity
    execution: false
    name: microsoft-atp-update-alert
    outputs:
    - contextPath: MicrosoftATP.Alert.ID
      description: Alert ID
      type: string
    - contextPath: MicrosoftATP.Alert.Status
      description: Alert status
      type: string
    - contextPath: MicrosoftATP.Alert.Classification
      description: Alert classification
      type: string
    - contextPath: MicrosoftATP.Alert.Determination
      description: Alert determination
      type: string
  - arguments:
    - default: true
      description: The query to run.
      isArray: false
      name: query
      required: true
      secret: false
    deprecated: false
    description: 'Allows you to run programmatic queries like in Windows Defender
      ATP Portal (https://securitycenter.windows.com/hunting). Limitations: You can
      only run a query on data from the last 30 days, The results will include a maximum
      of 10,000 rows, The number of executions is limited (up to 15 calls per minute,
      15 minutes of running time every hour and 4 hours of running time a day)'
    execution: false
    name: microsoft-atp-advanced-hunting
    outputs:
    - contextPath: MicrosoftATP.Hunt.Result
      description: Results of the query.
      type: Unknown
  - arguments:
    - default: false
      description: Id of the machine on which the event was identified. Required.
      isArray: false
      name: machine_id
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: Severity of the alert.
      isArray: false
      name: severity
      predefined:
      - Low
      - Medium
      - High
      required: true
      secret: false
    - default: false
      description: Title for the alert.
      isArray: false
      name: title
      required: true
      secret: false
    - default: false
      description: Description of the alert.
      isArray: false
      name: description
      required: true
      secret: false
    - default: false
      description: Action that is recommended to be taken by security officer when
        analyzing the alert.
      isArray: false
      name: recommended_action
      required: true
      secret: false
    - default: false
      description: The time of the event, as obtained from the advanced query.
      isArray: false
      name: event_time
      required: true
      secret: false
    - default: false
      description: The reportId, as obtained from the advanced query.
      isArray: false
      name: report_id
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: None
      description: Category of the alert.
      isArray: false
      name: category
      predefined:
      - None
      - SuspiciousActivity
      - Malware
      - CredentialTheft
      - Exploit
      - WebExploit
      - DocumentExploit
      - PrivilegeEscalation
      - Persistence
      - RemoteAccessTool
      - CommandAndControl
      - SuspiciousNetworkTraffic
      - Ransomware
      - MalwareDownload
      - Reconnaissance
      - WebFingerprinting
      - Weaponization
      - Delivery
      - SocialEngineering
      - CredentialStealing
      - Installation
      - Backdoor
      - Trojan
      - TrojanDownloader
      - LateralMovement
      - ExplorationEnumeration
      - NetworkPropagation
      - Exfiltration
      - NotApplicable
      - EnterprisePolicy
      - General
      required: false
      secret: false
    deprecated: false
    description: Create a new alert entity using event data, as obtained from the
      Advanced Hunting.
    execution: false
    name: microsoft-atp-create-alert
    outputs:
    - contextPath: MicrosoftATP.Alert.MachineID
      description: Alert machine ID
      type: string
    - contextPath: MicrosoftATP.Alert.RecommendedAction
      description: Alert recommended action
      type: string
    - contextPath: MicrosoftATP.Alert.Title
      description: Alert title
      type: string
    - contextPath: MicrosoftATP.Alert.Description
      description: Alert description
      type: string
    - contextPath: MicrosoftATP.Alert.Severity
      description: Alert severity
      type: string
    - contextPath: MicrosoftATP.Alert.Category
      description: Alert category
      type: string
    - contextPath: MicrosoftATP.Alert.ReportID
      description: Alert report ID
      type: string
    - contextPath: MicrosoftATP.Alert.EventTime
      description: Event time of the alert, as created by the user
      type: date
    - contextPath: MicrosoftATP.Alert.ID
      description: ID of the created alert.
      type: string
    - contextPath: MicrosoftATP.Alert.Status
      description: Status of the alert
      type: string
  - arguments:
    - default: false
      description: ID of the alert.
      isArray: false
      name: id
      required: true
      secret: false
    deprecated: false
    description: Retrieves the user associated to a specific alert.
    execution: false
    name: microsoft-atp-get-alert-related-user
    outputs:
    - contextPath: MicrosoftATP.User.ID
      description: ID of the related user.
      type: string
    - contextPath: MicrosoftATP.User.AlertID
      description: ID of the alert.
      type: string
    - contextPath: MicrosoftATP.User.FirstSeen
      description: First seen date of the related user.
      type: date
    - contextPath: MicrosoftATP.User.LastSeen
      description: Last seen date of the related user.
      type: date
    - contextPath: MicrosoftATP.User.MostPrevalentMachineID
      description: The most prevalent machine ID related to the user.
      type: string
    - contextPath: MicrosoftATP.User.LogonTypes
      description: Types of logon for the related user.
      type: string
    - contextPath: MicrosoftATP.User.LogonCount
      description: Log on machine count.
      type: string
    - contextPath: MicrosoftATP.User.DomainAdmin
      description: Flag for user domain admin - set to true if related user is domain
        admin.
      type: boolean
    - contextPath: MicrosoftATP.User.NetworkUser
      description: Flag for network user only - set to true if related user is only
        network user.
      type: boolean
  - arguments:
    - default: false
      description: ID of the alert.
      isArray: false
      name: id
      required: true
      secret: false
    - default: false
      defaultValue: '50'
      description: The limit of files to display
      isArray: false
      name: limit
      required: false
      secret: false
    deprecated: false
    description: Retrieves the files associated to a specific alert.
    execution: false
    name: microsoft-atp-get-alert-related-files
    outputs:
    - contextPath: MicrosoftATP.AlertFile.Files.FilePublisher
      description: File publisher.
      type: Unknown
    - contextPath: MicrosoftATP.AlertFile.Files.Size
      description: Size of the file.
      type: Number
    - contextPath: MicrosoftATP.AlertFile.Files.GlobalLastObserved
      description: Last time the file was observed.
      type: Date
    - contextPath: MicrosoftATP.AlertFile.Files.Sha1
      description: Sha1 hash of the file content
      type: String
    - contextPath: MicrosoftATP.AlertFile.Files.IsValidCertificate
      description: Was signing certificate successfully verified by Microsoft Defender
        ATP agent.
      type: Number
    - contextPath: MicrosoftATP.AlertFile.Files.Sha256
      description: Sha256 hash of the file content
      type: String
    - contextPath: MicrosoftATP.AlertFile.Files.Signer
      description: File signer.
      type: String
    - contextPath: MicrosoftATP.AlertFile.Files.GlobalPrevalence
      description: File prevalence across organization
      type: Number
    - contextPath: MicrosoftATP.AlertFile.Files.DeterminationValue
      description: |
        Determination value.
      type: Unknown
    - contextPath: MicrosoftATP.AlertFile.Files.GlobalFirstObserved
      description: First time the file was observed.
      type: Date
    - contextPath: MicrosoftATP.AlertFile.Files.FileType
      description: Type of the file.
      type: Unknown
    - contextPath: MicrosoftATP.AlertFile.Files.SignerHash
      description: Hash of the signing certificate.
      type: String
    - contextPath: MicrosoftATP.AlertFile.Files.Issuer
      description: File issuer.
      type: String
    - contextPath: MicrosoftATP.AlertFile.Files.IsPeFile
      description: true if the file is portable executable (e.g. "DLL", "EXE", etc.)
      type: Number
    - contextPath: MicrosoftATP.AlertFile.Files.DeterminationType
      description: The determination type of the file.
      type: String
    - contextPath: MicrosoftATP.AlertFile.Files.FileProductName
      description: Product name.
      type: Unknown
    - contextPath: MicrosoftATP.AlertFile.Files.Md5
      description: Md5 hash of the file content
      type: String
  - arguments:
    - default: false
      description: ID of the alert.
      isArray: false
      name: id
      required: true
      secret: false
    deprecated: false
    description: Retrieves the ips associated to a specific alert.
    execution: false
    name: microsoft-atp-get-alert-related-ips
    outputs:
    - contextPath: MicrosoftATP.AlertIPs.IPs.IpAddress
      description: The address of the IP
      type: String
  - arguments:
    - default: false
      description: ID of the alert.
      isArray: false
      name: id
      required: true
      secret: false
    deprecated: false
    description: Retrieves the domains associated to a specific alert.
    execution: false
    name: microsoft-atp-get-alert-related-domains
    outputs:
    - contextPath: MicrosoftATP.AlertDomain.Domains.Domain
      description: The domain address
      type: String
  - arguments:
    - default: false
      description: ID of the action
      isArray: false
      name: id
      required: false
      secret: false
    deprecated: false
    description: Return the machine's actions. If you set an action id it will return
      the info on the specific action
    execution: false
    name: microsoft-atp-list-machine-actions
    outputs:
    - contextPath: MicrosoftATP.MachineAction.ID
      description: Identity of the Machine Action entity.
      type: String
    - contextPath: MicrosoftATP.MachineAction.Type
      description: Type of the action.
      type: String
    - contextPath: MicrosoftATP.MachineAction.Scope
      description: Scope of the action.
      type: Unknown
    - contextPath: MicrosoftATP.MachineAction.Requestor
      description: Identity of the person that executed the action.
      type: String
    - contextPath: MicrosoftATP.MachineAction.RequestorComment
      description: Comment that was written when issuing the action.
      type: String
    - contextPath: MicrosoftATP.MachineAction.Status
      description: Current status of the command.
      type: String
    - contextPath: MicrosoftATP.MachineAction.MachineID
      description: Id of the machine on which the action was executed.
      type: String
    - contextPath: MicrosoftATP.MachineAction.ComputerDNSName
      description: Name of the machine on which the action was executed.
      type: String
    - contextPath: MicrosoftATP.MachineAction.CreationDateTimeUtc
      description: The date and time when the action was created.
      type: Date
    - contextPath: MicrosoftATP.MachineAction.LastUpdateTimeUtc
      description: The last date and time when the action status was updated.
      type: Date
    - contextPath: MicrosoftATP.MachineAction.RelatedFileInfo.FileIdentifier
      description: The fileIdentifier
      type: String
    - contextPath: MicrosoftATP.MachineAction.RelatedFileInfo.FileIdentifierType
      description: 'FileIdentifierType with the possible values: "Sha1" ,"Sha256"
        and "Md5"'
      type: String
  - arguments:
    - default: false
      description: The machine ID
      isArray: false
      name: machine_id
      required: true
      secret: false
    - default: false
      description: Comment to associate with the action
      isArray: false
      name: comment
      required: true
      secret: false
    deprecated: false
    description: Collect investigation package from a machine.
    execution: false
    name: microsoft-atp-collect-investigation-package
    outputs:
    - contextPath: MicrosoftATP.MachineAction.ID
      description: Identity of the Machine Action entity.
      type: String
    - contextPath: MicrosoftATP.MachineAction.Type
      description: Type of the action.
      type: String
    - contextPath: MicrosoftATP.MachineAction.Scope
      description: Scope of the action.
      type: String
    - contextPath: MicrosoftATP.MachineAction.Requestor
      description: Identity of the person that executed the action.
      type: String
    - contextPath: MicrosoftATP.MachineAction.RequestorComment
      description: Comment that was written when issuing the action.
      type: String
    - contextPath: MicrosoftATP.MachineAction.Status
      description: Current status of the command.
      type: String
    - contextPath: MicrosoftATP.MachineAction.MachineID
      description: Id of the machine on which the action was executed.
      type: String
    - contextPath: MicrosoftATP.MachineAction.ComputerDNSName
      description: Name of the machine on which the action was executed.
      type: String
    - contextPath: MicrosoftATP.MachineAction.CreationDateTimeUtc
      description: The date and time when the action was created.
      type: Date
    - contextPath: MicrosoftATP.MachineAction.LastUpdateDateTimeUtc
      description: The last date and time when the action status was updated.
      type: Date
    - contextPath: MicrosoftATP.MachineAction.RelatedFileInfo.FileIdentifier
      description: The fileIdentifier
      type: String
    - contextPath: MicrosoftATP.MachineAction.RelatedFileInfo.FileIdentifierType
      description: 'FileIdentifierType with the possible values: "Sha1" ,"Sha256"
        and "Md5"'
      type: String
  - arguments:
    - default: false
      description: machine action ID
      isArray: false
      name: action_id
      required: true
      secret: false
    deprecated: false
    description: Get a URI that allows downloading of an Investigation package
    execution: false
    name: microsoft-atp-get-investigation-package-sas-uri
    outputs:
    - contextPath: MicrosoftATP.InvestigationURI.Link
      description: Investigation package URI
      type: String
  - arguments:
    - default: false
      description: The machine ID
      isArray: false
      name: machine_id
      required: true
      secret: false
    - default: false
      description: Comment to associate with the action
      isArray: false
      name: comment
      required: false
      secret: false
    deprecated: false
    description: Restrict execution of all applications on the machine except a predefined
      set.
    execution: false
    name: microsoft-atp-restrict-app-execution
    outputs:
    - contextPath: MicrosoftATP.MachineAction.ID
      type: String
    - contextPath: MicrosoftATP.MachineAction.Type
      type: String
    - contextPath: MicrosoftATP.MachineAction.Scope
      type: String
    - contextPath: MicrosoftATP.MachineAction.Requestor
      type: String
    - contextPath: MicrosoftATP.MachineAction.RequestorComment
      type: String
    - contextPath: MicrosoftATP.MachineAction.Status
      type: String
    - contextPath: MicrosoftATP.MachineAction.MachineID
      type: String
    - contextPath: MicrosoftATP.MachineAction.ComputerDNSName
      type: String
    - contextPath: MicrosoftATP.MachineAction.CreationDateTimeUtc
      type: Date
    - contextPath: MicrosoftATP.MachineAction.LastUpdateDateTimeUtc
      type: Date
    - contextPath: MicrosoftATP.MachineAction.RelatedFileInfo
      type: Unknown
  - arguments:
    - default: false
      description: The machine ID
      isArray: false
      name: machine_id
      required: true
      secret: false
    - default: false
      description: Comment to associate with the action
      isArray: false
      name: comment
      required: true
      secret: false
    deprecated: false
    description: Enable execution of any application on the machine.
    execution: false
    name: microsoft-atp-remove-app-restriction
    outputs:
    - contextPath: MicrosoftATP.MachineAction.ID
      type: String
    - contextPath: MicrosoftATP.MachineAction.Type
      type: String
    - contextPath: MicrosoftATP.MachineAction.Scope
      type: String
    - contextPath: MicrosoftATP.MachineAction.Requestor
      type: String
    - contextPath: MicrosoftATP.MachineAction.RequestorComment
      type: String
    - contextPath: MicrosoftATP.MachineAction.Status
      type: String
    - contextPath: MicrosoftATP.MachineAction.MachineID
      type: String
    - contextPath: MicrosoftATP.MachineAction.ComputerDNSName
      type: String
    - contextPath: MicrosoftATP.MachineAction.CreationDateTimeUtc
      type: Date
    - contextPath: MicrosoftATP.MachineAction.LastUpdateDateTimeUtc
      type: Date
    - contextPath: MicrosoftATP.MachineAction.RelatedFileInfo
      type: Unknown
  - arguments:
    - default: false
      description: The machine ID
      isArray: false
      name: machine_id
      required: true
      secret: false
    - default: false
      description: The file sha1 hash to stop and quarantine on the machine.
      isArray: false
      name: sha1
      required: true
      secret: false
    - default: false
      description: Comment to associate with the action.
      isArray: false
      name: comment
      required: true
      secret: false
    deprecated: false
    description: Stop execution of a file on a machine and delete it.
    execution: false
    name: microsoft-atp-stop-and-quarantine-file
    outputs:
    - contextPath: MicrosoftATP.MachineAction.ID
      type: String
    - contextPath: MicrosoftATP.MachineAction.Type
      type: String
    - contextPath: MicrosoftATP.MachineAction.Scope
      type: String
    - contextPath: MicrosoftATP.MachineAction.Requestor
      type: String
    - contextPath: MicrosoftATP.MachineAction.RequestorComment
      type: String
    - contextPath: MicrosoftATP.MachineAction.Status
      type: String
    - contextPath: MicrosoftATP.MachineAction.MachineID
      type: String
    - contextPath: MicrosoftATP.MachineAction.ComputerDNSName
      type: String
    - contextPath: MicrosoftATP.MachineAction.CreationDateTimeUtc
      type: Date
    - contextPath: MicrosoftATP.MachineAction.LastUpdateDateTimeUtc
      type: Date
    - contextPath: MicrosoftATP.MachineAction.RelatedFileInfo
      type: Unknown
  - arguments:
    - default: false
      description: ID can be the investigation ID or the investigation triggering
        alert ID
      isArray: false
      name: id
      required: false
      secret: false
    deprecated: false
    description: Retrieves a collection of Investigations or retrieves specific Investigation
      by its ID
    execution: false
    name: microsoft-atp-list-investigations
    outputs:
    - contextPath: MicrosoftATP.Investigation.ID
      type: String
    - contextPath: MicrosoftATP.Investigation.StartTime
      type: Date
    - contextPath: MicrosoftATP.Investigation.EndTime
      type: Unknown
    - contextPath: MicrosoftATP.Investigation.State
      type: String
    - contextPath: MicrosoftATP.Investigation.CancelledBy
      type: Unknown
    - contextPath: MicrosoftATP.Investigation.StatusDetails
      type: Unknown
    - contextPath: MicrosoftATP.Investigation.MachineID
      type: String
    - contextPath: MicrosoftATP.Investigation.ComputerDNSName
      type: String
    - contextPath: MicrosoftATP.Investigation.TriggeringAlertId
      type: String
  - arguments:
    - default: false
      description: The machine's ID
      isArray: false
      name: machine_id-p
      required: true
      secret: false
    - default: false
      description: Comment to associate with the action.
      isArray: false
      name: comment
      required: true
      secret: false
    deprecated: false
    description: Start automated investigation on a machine.
    execution: false
    name: microsoft-atp-start-investigation
    outputs:
    - contextPath: MicrosoftATP.Investigation.ID
      type: String
    - contextPath: MicrosoftATP.Investigation.StartTime
      type: Date
    - contextPath: MicrosoftATP.Investigation.EndTime
      type: Unknown
    - contextPath: MicrosoftATP.Investigation.State
      type: String
    - contextPath: MicrosoftATP.Investigation.CancelledBy
      type: Unknown
    - contextPath: MicrosoftATP.Investigation.StatusDetails
      type: Unknown
    - contextPath: MicrosoftATP.Investigation.MachineID
      type: String
    - contextPath: MicrosoftATP.Investigation.ComputerDNSName
      type: String
    - contextPath: MicrosoftATP.Investigation.TriggeringAlertId
      type: String
  - arguments:
    - default: false
      description: The domain address
      isArray: false
      name: domain
      required: true
      secret: false
    deprecated: false
    description: Retrieves the statistics on the given domain.
    execution: false
    name: microsoft-atp-get-domain-statistics
    outputs:
    - contextPath: MicrosoftATP.DomainStatistics.Statistics.Host
      type: String
    - contextPath: MicrosoftATP.DomainStatistics.Statistics.OrgPrevalence
      type: String
    - contextPath: MicrosoftATP.DomainStatistics.Statistics.OrgFirstSeen
      type: Date
    - contextPath: MicrosoftATP.DomainStatistics.Statistics.OrgLastSeen
      type: Date
  - arguments:
    - default: false
      description: The domain address
      isArray: false
      name: domain
      required: true
      secret: false
    deprecated: false
    description: Retrieves a collection of Alerts related to a given domain address.
    execution: false
    name: microsoft-atp-get-domain-alerts
    outputs:
    - contextPath: MicrosoftATP.DomainAlert.Alerts.ID
      type: String
    - contextPath: MicrosoftATP.DomainAlert.Alerts.IncidentID
      type: Number
    - contextPath: MicrosoftATP.DomainAlert.Alerts.InvestigationID
      type: Number
    - contextPath: MicrosoftATP.DomainAlert.Alerts.InvestigationState
      type: String
    - contextPath: MicrosoftATP.DomainAlert.Alerts.AssignedTo
      type: String
    - contextPath: MicrosoftATP.DomainAlert.Alerts.Severity
      type: String
    - contextPath: MicrosoftATP.DomainAlert.Alerts.Status
      type: String
    - contextPath: MicrosoftATP.DomainAlert.Alerts.Classification
      type: String
    - contextPath: MicrosoftATP.DomainAlert.Alerts.Determination
      type: Unknown
    - contextPath: MicrosoftATP.DomainAlert.Alerts.DetectionSource
      type: String
    - contextPath: MicrosoftATP.DomainAlert.Alerts.Category
      type: String
    - contextPath: MicrosoftATP.DomainAlert.Alerts.ThreatFamilyName
      type: Unknown
    - contextPath: MicrosoftATP.DomainAlert.Alerts.Title
      type: String
    - contextPath: MicrosoftATP.DomainAlert.Alerts.Description
      type: String
    - contextPath: MicrosoftATP.DomainAlert.Alerts.AlertCreationTime
      type: Date
    - contextPath: MicrosoftATP.DomainAlert.Alerts.FirstEventTime
      type: Date
    - contextPath: MicrosoftATP.DomainAlert.Alerts.LastEventTime
      type: Date
    - contextPath: MicrosoftATP.DomainAlert.Alerts.LastUpdateTime
      type: Date
    - contextPath: MicrosoftATP.DomainAlert.Alerts.ResolvedTime
      type: Unknown
    - contextPath: MicrosoftATP.DomainAlert.Alerts.MachineID
      type: String
    - contextPath: MicrosoftATP.DomainAlert.Alerts.Comments.Comment
      type: String
    - contextPath: MicrosoftATP.DomainAlert.Alerts.Comments.CreatedBy
      type: String
    - contextPath: MicrosoftATP.DomainAlert.Alerts.Comments.CreatedTime
      type: Date
  - arguments:
    - default: false
      description: The domain address
      isArray: false
      name: domain
      required: true
      secret: false
    deprecated: false
    description: Retrieves a collection of Machines that have communicated to or from
      a given domain address.
    execution: false
    name: microsoft-atp-get-domain-machines
    outputs:
    - contextPath: MicrosoftATP.DomainMachine.Machines.ID
      type: String
    - contextPath: MicrosoftATP.DomainMachine.Machines.ComputerDNSName
      type: String
    - contextPath: MicrosoftATP.DomainMachine.Machines.FirstSeen
      type: Date
    - contextPath: MicrosoftATP.DomainMachine.Machines.LastSeen
      type: Date
    - contextPath: MicrosoftATP.DomainMachine.Machines.OSPlatform
      type: String
    - contextPath: MicrosoftATP.DomainMachine.Machines.Version
      type: String
    - contextPath: MicrosoftATP.DomainMachine.Machines.OSProcessor
      type: String
    - contextPath: MicrosoftATP.DomainMachine.Machines.LastIPAddress
      type: String
    - contextPath: MicrosoftATP.DomainMachine.Machines.LastExternalIPAddress
      type: String
    - contextPath: MicrosoftATP.DomainMachine.Machines.OSBuild
      type: Number
    - contextPath: MicrosoftATP.DomainMachine.Machines.HealthStatus
      type: String
    - contextPath: MicrosoftATP.DomainMachine.Machines.RBACGroupID
      type: Number
    - contextPath: MicrosoftATP.DomainMachine.Machines.RBACGroupName
      type: String
    - contextPath: MicrosoftATP.DomainMachine.Machines.RiskScore
      type: String
    - contextPath: MicrosoftATP.DomainMachine.Machines.ExposureLevel
      type: String
    - contextPath: MicrosoftATP.DomainMachine.Machines.IsAADJoined
      type: Number
    - contextPath: MicrosoftATP.DomainMachine.Machines.AADDeviceId
      type: String
    - contextPath: MicrosoftATP.DomainMachine.Machines.MachineTags
      type: String
  - arguments:
    - default: false
      description: File sha1 hash to get statistics on
      isArray: false
      name: sha1
      required: true
      secret: false
    deprecated: false
    description: Retrieves the statistics for the given file.
    execution: false
    name: microsoft-atp-get-file-statistics
    outputs:
    - contextPath: MicrosoftATP.FileStatistics.Statistics.Sha1
      type: String
    - contextPath: MicrosoftATP.FileStatistics.Statistics.OrgPrevalence
      type: String
    - contextPath: MicrosoftATP.FileStatistics.Statistics.OrgFirstSeen
      type: Date
    - contextPath: MicrosoftATP.FileStatistics.Statistics.OrgLastSeen
      type: Date
    - contextPath: MicrosoftATP.FileStatistics.Statistics.GlobalPrevalence
      type: String
    - contextPath: MicrosoftATP.FileStatistics.Statistics.GlobalFirstObserved
      type: Date
    - contextPath: MicrosoftATP.FileStatistics.Statistics.GlobalLastObserved
      type: Date
    - contextPath: MicrosoftATP.FileStatistics.Statistics.TopFileNames
      type: String
  - arguments:
    - default: false
      description: File sha1 hash to get statistics on
      isArray: false
      name: sha1
      required: true
      secret: false
    deprecated: false
    description: Retrieves a collection of alerts related to a given file hash.
    execution: false
    name: microsoft-atp-get-file-alerts
    outputs:
    - contextPath: MicrosoftATP.FileAlert.Alerts.ID
      type: String
    - contextPath: MicrosoftATP.FileAlert.Alerts.IncidentId
      type: Number
    - contextPath: MicrosoftATP.FileAlert.Alerts.InvestigationID
      type: Number
    - contextPath: MicrosoftATP.FileAlert.Alerts.InvestigationState
      type: String
    - contextPath: MicrosoftATP.FileAlert.Alerts.AssignedTo
      type: String
    - contextPath: MicrosoftATP.FileAlert.Alerts.Severity
      type: String
    - contextPath: MicrosoftATP.FileAlert.Alerts.Status
      type: String
    - contextPath: MicrosoftATP.FileAlert.Alerts.Classification
      type: String
    - contextPath: MicrosoftATP.FileAlert.Alerts.Determination
      type: Unknown
    - contextPath: MicrosoftATP.FileAlert.Alerts.DetectionSource
      type: String
    - contextPath: MicrosoftATP.FileAlert.Alerts.Category
      type: String
    - contextPath: MicrosoftATP.FileAlert.Alerts.ThreatFamilyName
      type: Unknown
    - contextPath: MicrosoftATP.FileAlert.Alerts.Title
      type: String
    - contextPath: MicrosoftATP.FileAlert.Alerts.Description
      type: String
    - contextPath: MicrosoftATP.FileAlert.Alerts.AlertCreationTime
      type: Date
    - contextPath: MicrosoftATP.FileAlert.Alerts.FirstEventTime
      type: Date
    - contextPath: MicrosoftATP.FileAlert.Alerts.LastEventTime
      type: Date
    - contextPath: MicrosoftATP.FileAlert.Alerts.LastUpdateTime
      type: Date
    - contextPath: MicrosoftATP.FileAlert.Alerts.ResolvedTime
      type: Unknown
    - contextPath: MicrosoftATP.FileAlert.Alerts.MachineID
      type: String
    - contextPath: MicrosoftATP.FileAlert.Alerts.Comments.Comment
      type: String
    - contextPath: MicrosoftATP.FileAlert.Alerts.Comments.CreatedBy
      type: String
    - contextPath: MicrosoftATP.FileAlert.Alerts.Comments.CreatedTime
      type: Date
  - arguments:
    - default: false
      description: The IP address
      isArray: false
      name: ip
      required: true
      secret: false
    deprecated: false
    description: Retrieves the statistics for the given IP.
    execution: false
    name: microsoft-atp-get-ip-statistics
    outputs:
    - contextPath: MicrosoftATP.IPStatistics.Statistics.IPAddress
      type: String
    - contextPath: MicrosoftATP.IPStatistics.Statistics.OrgPrevalence
      type: String
    - contextPath: MicrosoftATP.IPStatistics.Statistics.OrgFirstSeen
      type: Date
    - contextPath: MicrosoftATP.IPStatistics.Statistics.OrgLastSeen
      type: Date
  - arguments:
    - default: false
      description: The Ip address
      isArray: false
      name: ip
      required: true
      secret: false
    deprecated: false
    description: Retrieves a collection of alerts related to a given IP address.
    execution: false
    name: microsoft-atp-get-ip-alerts
    outputs:
    - contextPath: MicrosoftATP.IPAlert.Alerts.ID
      type: String
    - contextPath: MicrosoftATP.IPAlert.Alerts.IncidentID
      type: Number
    - contextPath: MicrosoftATP.IPAlert.Alerts.InvestigationID
      type: Number
    - contextPath: MicrosoftATP.IPAlert.Alerts.InvestigationState
      type: String
    - contextPath: MicrosoftATP.IPAlert.Alerts.AssignedTo
      type: String
    - contextPath: MicrosoftATP.IPAlert.Alerts.Severity
      type: String
    - contextPath: MicrosoftATP.IPAlert.Alerts.Status
      type: String
    - contextPath: MicrosoftATP.IPAlert.Alerts.Classification
      type: String
    - contextPath: MicrosoftATP.IPAlert.Alerts.Determination
      type: Unknown
    - contextPath: MicrosoftATP.IPAlert.Alerts.DetectionSource
      type: String
    - contextPath: MicrosoftATP.IPAlert.Alerts.Category
      type: String
    - contextPath: MicrosoftATP.IPAlert.Alerts.ThreatFamilyName
      type: Unknown
    - contextPath: MicrosoftATP.IPAlert.Alerts.Title
      type: String
    - contextPath: MicrosoftATP.IPAlert.Alerts.Description
      type: String
    - contextPath: MicrosoftATP.IPAlert.Alerts.AlertCreationTime
      type: Date
    - contextPath: MicrosoftATP.IPAlert.Alerts.FirstEventTime
      type: Date
    - contextPath: MicrosoftATP.IPAlert.Alerts.LastEventTime
      type: Date
    - contextPath: MicrosoftATP.IPAlert.Alerts.LastUpdateTime
      type: Date
    - contextPath: MicrosoftATP.IPAlert.Alerts.ResolvedTime
      type: Unknown
    - contextPath: MicrosoftATP.IPAlert.Alerts.MachineID
      type: String
    - contextPath: MicrosoftATP.IPAlert.Alerts.Comments.Comment
      type: String
    - contextPath: MicrosoftATP.IPAlert.Alerts.Comments.CreatedBy
      type: String
    - contextPath: MicrosoftATP.IPAlert.Alerts.Comments.CreatedTime
      type: Date
  - arguments:
    - default: false
      description: |-
        The user ID.  Note that the id is not the full UPN, but only the user name.
         (e.g., to retrieve alerts for user1@contoso.com use user1)
      isArray: false
      name: username
      required: true
      secret: false
    deprecated: false
    description: Retrieves a collection of alerts related to a given user ID.
    execution: false
    name: microsoft-atp-get-user-alerts
    outputs:
    - contextPath: MicrosoftATP.UserAlert.Alerts.ID
      type: String
    - contextPath: MicrosoftATP.UserAlert.Alerts.IncidentID
      type: Number
    - contextPath: MicrosoftATP.UserAlert.Alerts.InvestigationID
      type: Number
    - contextPath: MicrosoftATP.UserAlert.Alerts.InvestigationState
      type: String
    - contextPath: MicrosoftATP.UserAlert.Alerts.AssignedTo
      type: String
    - contextPath: MicrosoftATP.UserAlert.Alerts.Severity
      type: String
    - contextPath: MicrosoftATP.UserAlert.Alerts.Status
      type: String
    - contextPath: MicrosoftATP.UserAlert.Alerts.Classification
      type: String
    - contextPath: MicrosoftATP.UserAlert.Alerts.Determination
      type: Unknown
    - contextPath: MicrosoftATP.UserAlert.Alerts.DetectionSource
      type: String
    - contextPath: MicrosoftATP.UserAlert.Alerts.Category
      type: String
    - contextPath: MicrosoftATP.UserAlert.Alerts.ThreatFamilyName
      type: Unknown
    - contextPath: MicrosoftATP.UserAlert.Alerts.Title
      type: String
    - contextPath: MicrosoftATP.UserAlert.Alerts.Description
      type: String
    - contextPath: MicrosoftATP.UserAlert.Alerts.AlertCreationTime
      type: Date
    - contextPath: MicrosoftATP.UserAlert.Alerts.FirstEventTime
      type: Date
    - contextPath: MicrosoftATP.UserAlert.Alerts.LastEventTime
      type: Date
    - contextPath: MicrosoftATP.UserAlert.Alerts.LastUpdateTime
      type: Date
    - contextPath: MicrosoftATP.UserAlert.Alerts.ResolvedTime
      type: Unknown
    - contextPath: MicrosoftATP.UserAlert.Alerts.MachineID
      type: String
    - contextPath: MicrosoftATP.UserAlert.Alerts.Comments.Comment
      type: String
    - contextPath: MicrosoftATP.UserAlert.Alerts.Comments.CreatedBy
      type: String
    - contextPath: MicrosoftATP.UserAlert.Alerts.Comments.CreatedTime
      type: Date
  - arguments:
    - default: false
      description: |-
        The user ID.  Note that the id is not the full UPN, but only the user name.
        (e.g., to retrieve machines for user1@contoso.com use user1)
      isArray: false
      name: username
      required: true
      secret: false
    deprecated: false
    description: Retrieves a collection of machines related to a given user ID.
    execution: false
    name: microsoft-atp-get-user-machines
    outputs:
    - contextPath: MicrosoftATP.UsernMachine.Machines.ID
      type: String
    - contextPath: MicrosoftATP.UsernMachine.Machines.ComputerDNSName
      type: String
    - contextPath: MicrosoftATP.UsernMachine.Machines.FirstSeen
      type: Date
    - contextPath: MicrosoftATP.UsernMachine.Machines.LastSeen
      type: Date
    - contextPath: MicrosoftATP.UsernMachine.Machines.OSPlatform
      type: String
    - contextPath: MicrosoftATP.UsernMachine.Machines.Version
      type: String
    - contextPath: MicrosoftATP.UsernMachine.Machines.OSProcessor
      type: String
    - contextPath: MicrosoftATP.UsernMachine.Machines.LastIpAddress
      type: String
    - contextPath: MicrosoftATP.UsernMachine.Machines.LastExternalIpAddress
      type: String
    - contextPath: MicrosoftATP.UsernMachine.Machines.OSBuild
      type: Number
    - contextPath: MicrosoftATP.UsernMachine.Machines.HealthStatus
      type: String
    - contextPath: MicrosoftATP.UsernMachine.Machines.RBACGroupId
      type: Number
    - contextPath: MicrosoftATP.UsernMachine.Machines.RBACGroupName
      type: String
    - contextPath: MicrosoftATP.UsernMachine.Machines.RiskScore
      type: String
    - contextPath: MicrosoftATP.UsernMachine.Machines.ExposureLevel
      type: String
    - contextPath: MicrosoftATP.UsernMachine.Machines.IsAADJoined
      type: Number
    - contextPath: MicrosoftATP.UsernMachine.Machines.AADDeviceId
      type: String
    - contextPath: MicrosoftATP.UsernMachine.Machines.MachineTags
      type: String
  - arguments:
    - default: false
      description: The machine ID
      isArray: false
      name: machine_id
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: The action to use for the tag
      isArray: false
      name: action
      predefined:
      - Add
      - Remove
      required: true
      secret: false
    - default: false
      description: The tag name
      isArray: false
      name: tag
      required: true
      secret: false
    deprecated: false
    description: Adds or remove tag to a specific Machine.
    execution: false
    name: microsoft-atp-add-remove-machine-tag
    outputs:
    - contextPath: MicrosoftATP.Machine.ID
      type: String
    - contextPath: MicrosoftATP.Machine.ComputerDNSName
      type: String
    - contextPath: MicrosoftATP.Machine.FirstSeen
      type: Date
    - contextPath: MicrosoftATP.Machine.LastSeen
      type: Date
    - contextPath: MicrosoftATP.Machine.OSPlatform
      type: String
    - contextPath: MicrosoftATP.Machine.Version
      type: String
    - contextPath: MicrosoftATP.Machine.OSProcessor
      type: String
    - contextPath: MicrosoftATP.Machine.LastIPAddress
      type: String
    - contextPath: MicrosoftATP.Machine.LastExternalIPAddress
      type: String
    - contextPath: MicrosoftATP.Machine.OSBuild
      type: Number
    - contextPath: MicrosoftATP.Machine.HealthStatus
      type: String
    - contextPath: MicrosoftATP.Machine.RBACGroupID
      type: Number
    - contextPath: MicrosoftATP.Machine.RBACGroupName
      type: String
    - contextPath: MicrosoftATP.Machine.RiskScore
      type: String
    - contextPath: MicrosoftATP.Machine.ExposureLevel
      type: String
    - contextPath: MicrosoftATP.Machine.IsAADJoined
      type: Number
    - contextPath: MicrosoftATP.Machine.AADDeviceID
      type: String
    - contextPath: MicrosoftATP.Machine.MachineTags
      type: String
  dockerimage: demisto/crypto:1.0.0.303
  feed: false
  isfetch: true
  longRunning: false
  longRunningPort: false
  runonce: false
  script: '-'
  subtype: python3
  type: python
tests:
- Test - Windows Defender Advanced Threat Protection
