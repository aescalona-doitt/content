commonfields:
  id: Microsoft Management
  version: -1
contentitemfields:
  propagationLabels: []
name: Microsoft Management
display: Microsoft Management
category: Data Enrichment & Threat Intelligence
image: data:image/png;base64,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
configuration:
- display: Authentication code
  name: auth_code
  defaultvalue: ""
  type: 4
  required: true
  additionalinfo: The authentication code provided to you by Microsoft. For instructions
    on how to obtain this see the integration's documentation.
- display: Redirect URI
  name: redirect_uri
  defaultvalue: ""
  type: 0
  required: true
  additionalinfo: The redirect URI you have defined on Azure portal.
- display: Client Secret
  name: client_secret
  defaultvalue: ""
  type: 4
  required: true
  additionalinfo: The client secret from Azure portal.
- display: Client ID
  name: client_id
  defaultvalue: ""
  type: 0
  required: true
  additionalinfo: Your client ID on Azure  portal.
- display: Base URL
  name: base_url
  defaultvalue: https://manage.office.com/api/v1.0/
  type: 0
  required: false
  additionalinfo: The base URL for Microsoft Management's API.
- display: Trust any certificate (not secure)
  name: insecure
  defaultvalue: ""
  type: 8
  required: false
- display: Use system proxy settings
  name: proxy
  defaultvalue: ""
  type: 0
  required: false
- display: First fetch start (minutes)
  name: first_fetch_delta
  defaultvalue: "1440"
  type: 0
  required: false
  additionalinfo: The time from which to start the first fetch. For example, if specified
    "60" events from the last hour will be pulled. Max is 1440.
- display: Content types to fetch
  name: content_types_to_fetch
  defaultvalue: ""
  type: 16
  required: false
  options:
  - Audit.AzureActiveDirectory
  - Audit.Exchange
  - Audit.SharePoint
  - Audit.General
  additionalinfo: The content types you wish to fetch content records from.
script:
  script: ''
  type: python
  commands:
  - name: ms-management-start-subscription
    arguments:
    - name: content_type
      required: true
      auto: PREDEFINED
      predefined:
      - Audit.AzureActiveDirectory
      - Audit.Exchange
      - Audit.SharePoint
      - Audit.General
      description: The content type to subscribe to.
    description: Starts a subscription to a given content type
  - name: ms-management-stop-subscription
    arguments:
    - name: content_type
      required: true
      auto: PREDEFINED
      predefined:
      - Audit.AzureActiveDirectory
      - Audit.Exchange
      - Audit.SharePoint
      - Audit.General
      description: The content type to stop being subscribed to.
    description: Stops a subscription to a given content type
  - name: ms-management-list-subscriptions
    arguments: []
    outputs:
    - contextPath: MicrosoftManagement.Subscription
      description: List of current subscriptions
      type: string
    description: List the content types you are currently subscribed to
  - name: ms-management-list-content
    arguments:
    - name: content_type
      required: true
      auto: PREDEFINED
      predefined:
      - Audit.AzureActiveDirectory
      - Audit.Exchange
      - Audit.SharePoint
      - Audit.General
      description: The content type you wish to receive content of.
    - name: start_time
      description: 'The earliest time to get content from. If start_time is specified,
        end_time must be specified as well. The start_time must be before the end_time,
        can be at most 7 days ago, and has to be within 24 hours from end_time. Required
        format: YYYY-MM-DDTHH-MM-SS. If not specified, start time will be 24 hours
        ago.'
    - name: end_time
      description: 'The latest time to get content from. If end_time is specified,
        start_time must be specified as well. The start_time must be before the end_time
        and has to be within 24 hours from start_time. Required format: YYYY-MM-DDTHH-MM-SS.
        If not specified, end_time will be now.'
    outputs:
    - contextPath: MicrosoftManagement.ContentRecord.ID
      description: The ID of the record.
      type: number
    - contextPath: MicrosoftManagement.ContentRecord.CreationTime
      description: The creation time of the record.
      type: date
    - contextPath: MicrosoftManagement.ContentRecord.RecordType
      description: The type of the record.
    - contextPath: MicrosoftManagement.ContentRecord.Operation
      description: The operation described in the record.
    - contextPath: MicrosoftManagement.ContentRecord.UserType
      description: The type of the related user.
      type: string
    - contextPath: MicrosoftManagement.ContentRecord.OrganizationID
      description: The ID of the organization relevant to the record.
      type: number
    - contextPath: MicrosoftManagement.ContentRecord.UserKey
      description: The key of the related user.
      type: string
    - contextPath: MicrosoftManagement.ContentRecord.ClientIP
      description: The IP of the record's client.
      type: string
    - contextPath: MicrosoftManagement.ContentRecord.Scope
      description: The scope of the record.
      type: string
    - contextPath: MicrosoftManagement.ContentRecord.Workload
      description: The workload of the record.
      type: string
    - contextPath: MicrosoftManagement.ContentRecord.ResultsStatus
      description: The results status of the record.
      type: string
    - contextPath: MicrosoftManagement.ContentRecord.ObjectID
      description: The ID of the record's object.
      type: string
    - contextPath: MicrosoftManagement.ContentRecord.UserID
      description: The ID of the record's user.
      type: string
    description: Returns all content of a specific content type.
  dockerimage: demisto/pyjwt3:1.0.0.4946
  runonce: false
  subtype: python3
