category: Email Gateway
commonfields:
  id: Proofpoint Threat Response
  version: -1
configuration:
- display: Server URL (e.g. https://192.168.0.1)
  name: url
  required: true
  type: 0
- display: API Key
  name: apikey
  required: true
  type: 4
- defaultvalue: ''
  display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- defaultvalue: 'false'
  display: Use system proxy settings
  name: proxy
  required: false
  type: 8
- display: Fetch incidents
  name: isFetch
  required: false
  type: 8
- display: Incident type
  name: incidentType
  required: false
  type: 13
- display: 'First fetch timestamp (YYYY-MM-DD''T''HH:MM:SS''Z''. For example: 2020-02-02T19:00:00Z'
  name: fetch_time
  required: false
  type: 0
- display: Fetch incidents with specific event sources. Can be a list of comma separated
    values.
  name: event_sources
  required: false
  type: 0
- display: Fetch incidents with specific 'Abuse Disposition' values. Can be a list
    of comma separated values.
  name: abuse_disposition
  required: false
  type: 0
- display: Fetch incident with specific states.
  name: states
  options:
  - new
  - open
  - assigned
  - closed
  - ignored
  required: false
  type: 16
description: Use the Proofpoint Threat Response integration to orchestrate and automate
  incident response.
display: Proofpoint Threat Response (Beta)
name: Proofpoint Threat Response
script:
  commands:
  - arguments:
    - default: false
      description: ID of the list.
      isArray: false
      name: list-id
      required: true
      secret: false
    deprecated: false
    description: Gets items for the specified list.
    execution: false
    name: proofpoint-tr-get-list
  - arguments:
    - default: false
      description: The list to add a member to.
      isArray: false
      name: list-id
      required: true
      secret: false
    - default: false
      description: 'The comma-separated list of indicator values. Can be IP addresses,
        URLs, domains, or file hashes. For example: "192.168.1.1,192.168.1.2".'
      isArray: true
      name: indicator
      required: true
      secret: false
    - default: false
      description: A comment about the member.
      isArray: false
      name: comment
      required: false
      secret: false
    - default: false
      description: Expiration of the  member.
      isArray: false
      name: expiration
      required: false
      secret: false
    deprecated: false
    description: Adds a member to the specified list.
    execution: true
    name: proofpoint-tr-add-to-list
  - arguments:
    - default: false
      description: A comma-separated list of IP addresses to blacklist.
      isArray: true
      name: ip
      required: true
      secret: false
    - default: false
      description: 'Date and time when the supplied IP addresses should be removed
        from the blacklist, in the format YYYY-MM-DDTHH:MM:SSZ. For example: 2020-02-02T19:00:00Z'
      isArray: false
      name: expiration
      required: false
      secret: false
    - default: false
      description: 'The ID of the IP blacklist. '
      isArray: false
      name: blacklist_ip
      required: true
      secret: false
    deprecated: false
    description: Adds the supplied IP addresses to the specified IP blacklist.
    execution: true
    name: proofpoint-tr-block-ip
  - arguments:
    - default: false
      description: A comma-separated list of domains to add to the blacklist.
      isArray: true
      name: domain
      required: true
      secret: false
    - default: false
      description: 'Date and time when the supplied IP addresses should be removed
        from the blacklist, in the format YYYY-MM-DDTHH:MM:SSZ. For example: 2020-02-02T19:00:00Z'
      isArray: false
      name: expiration
      required: false
      secret: false
    - default: false
      description: The ID of the domain blacklist.
      isArray: false
      name: blacklist_domain
      required: true
      secret: false
    deprecated: false
    description: Adds the supplied domains to the specified blacklist.
    execution: false
    name: proofpoint-tr-block-domain
  - arguments:
    - default: false
      description: The ID of the list in which to search.
      isArray: false
      name: list-id
      required: true
      secret: false
    - default: false
      description: The filter for the indicator search. For example, "1.1" will return
        [1.1.1.1, 22.22.1.1,1.1.22.22]
      isArray: false
      name: filter
      required: true
      secret: false
    deprecated: false
    description: Returns indicators for the specified list, according to the defined
      filter.
    execution: false
    name: proofpoint-tr-search-indicator
  - arguments:
    - default: false
      description: ID of the list from which to delete indicators.
      isArray: false
      name: list-id
      required: true
      secret: false
    - default: false
      description: 'The indicator value to delete from the list. Can be an IP address,
        URL, domain, or file hash. For example: "demisto.com".'
      isArray: false
      name: indicator
      required: true
      secret: false
    deprecated: false
    description: Deletes an indicator from the specified list.
    execution: false
    name: proofpoint-tr-delete-indicator
  - arguments:
    - default: false
      description: A comma-separated list of URLs to add to the URL blacklist.
      isArray: true
      name: url
      required: true
      secret: false
    - default: false
      description: 'Date and time when the supplied IP addresses should be removed
        from the blacklist, in the format YYYY-MM-DDTHH:MM:SSZ. For example: 2020-02-02T19:00:00Z'
      isArray: false
      name: expiration
      required: false
      secret: false
    - default: false
      description: The ID of the URL blacklist.
      isArray: false
      name: blacklist_url
      required: true
      secret: false
    deprecated: false
    description: Adds the supplied URLs to the specified URL blacklist.
    execution: false
    name: proofpoint-tr-block-url
  - arguments:
    - default: false
      description: A comma-separated list of file hashes to add to the file hash blacklist.
      isArray: true
      name: hash
      required: true
      secret: false
    - default: false
      description: 'Date and time when the supplied IP addresses should be removed
        from the blacklist, in the format YYYY-MM-DDTHH:MM:SSZ. For example: 2020-02-02T19:00:00Z'
      isArray: false
      name: expiration
      required: false
      secret: false
    - default: false
      description: The ID of the hash blacklist
      isArray: false
      name: blacklist_hash
      required: true
      secret: false
    deprecated: false
    description: Adds the supplied file hashes to the specified file hash blacklist.
    execution: false
    name: proofpoint-tr-block-hash
  - arguments:
    - auto: PREDEFINED
      default: false
      description: State of the incidents to retrieve
      isArray: false
      name: state
      predefined:
      - new
      - open
      - assigned
      - closed
      - ignored
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      defaultValue: 'Retrieve incidents that were created after specified date, in
        ISO 8601 format (UTC). Example: 2020-02-22'
      description: 'Retrieve incidents that were after created before a specified
        date, in ISO 8601 format (UTC). Example: 2020-02-22'
      isArray: false
      name: created_after
      predefined:
      - Retrieve incidents that were created after a specified date
      - ' in ISO 8601 format (UTC). Example: 2020-02-22'
      required: false
      secret: false
    - default: false
      description: 'Retrieve incidents that were created before a specified date,
        in ISO 8601 format (UTC). Example: 2020-02-22'
      isArray: false
      name: created_before
      required: false
      secret: false
    - default: false
      description: 'Retrieve incidents that were closed after a specified date, in
        ISO 8601 format (UTC). Example: 2020-02-22'
      isArray: false
      name: closed_after
      required: false
      secret: false
    - default: false
      description: 'Retrieve incidents that were closed before a specified date, in
        ISO 8601 format (UTC). Example: 2020-02-22'
      isArray: false
      name: closed_before
      required: false
      secret: false
    - auto: PREDEFINED
      default: false
      description: ' Setting expand_events to false will return an array of event
        idâ€™s instead of full event objects. This will significantly speed up the response
        time of the API for incidents with large numbers of alerts.'
      isArray: false
      name: expand_events
      predefined:
      - 'true'
      - 'false'
      required: false
      secret: false
    - default: false
      defaultValue: '50'
      description: The maximum number of incidents to return. The default value is
        50.
      isArray: false
      name: limit
      required: true
      secret: false
    deprecated: false
    description: Retrieve all incident metadata from Threat Response by specifying
      filter criteria such as the state of the incident or time of closure.
    execution: false
    name: proofpoint-tr-list-incidents
    outputs:
    - contextPath: ProofPointTRAP.Incident.id
      description: The incident ID
      type: Number
    - contextPath: ProofPointTRAP.Incident.summary
      description: The summary of the incident
      type: String
    - contextPath: ProofPointTRAP.Incident.score
      description: The score of the incident from ProofPoint
      type: Number
    - contextPath: ProofPointTRAP.Incident.state
      description: The state of the incident. Can be - Open, Closed, New, Assigned,
        Ignored
      type: String
    - contextPath: ProofPointTRAP.Incident.created_at
      description: The creation time of the incident
      type: Date
    - contextPath: ProofPointTRAP.Incident.updated_at
      description: The update time of the incident
      type: Date
    - contextPath: ProofPointTRAP.Incident.event_count
      description: The number of events attached to the incident
      type: Number
    - contextPath: ProofPointTRAP.Incident.false_positive_count
      description: The number of false positive events in the incident
      type: Number
    - contextPath: ProofPointTRAP.Incident.event_sources
      description: The sources of the events
      type: String
    - contextPath: ProofPointTRAP.Incident.assignee
      description: The user assigned to the incident
      type: String
    - contextPath: ProofPointTRAP.Incident.team
      description: The team assigned to the incident
      type: String
    - contextPath: ProofPointTRAP.Incident.hosts.attacker
      description: The host attacker
      type: String
    - contextPath: ProofPointTRAP.Incident.hosts.forensics
      description: The host forensics
      type: String
    - contextPath: ProofPointTRAP.Incident.incident_field_values.Severity
      description: The severity of the incident
      type: String
    - contextPath: ProofPointTRAP.Incident.incident_field_values.Abuse_disposition
      description: The abuse disposition of the incident
      type: String
    - contextPath: ProofPointTRAP.Incident.incident_field_values.Attack_vector
      description: The attack vector of the incident
      type: String
    - contextPath: ProofPointTRAP.Incident.incident_field_values.Classification
      description: The classification of the incident
      type: String
    - contextPath: ProofPointTRAP.Incident.events.id
      description: The event ID
      type: Number
    - contextPath: ProofPointTRAP.Incident.events.category
      description: The event category
      type: String
    - contextPath: ProofPointTRAP.Incident.events.alertType
      description: The alert type of the event
      type: String
    - contextPath: ProofPointTRAP.Incident.events.severity
      description: The severity of the event
      type: String
    - contextPath: ProofPointTRAP.Incident.events.source
      description: The source of the event
      type: String
    - contextPath: ProofPointTRAP.Incident.events.state
      description: The state of the event
      type: String
    - contextPath: ProofPointTRAP.Incident.events.attackDirection
      description: The attack direction of the event
      type: String
    - contextPath: ProofPointTRAP.Incident.events.received
      description: The time the incident was recieved
      type: Date
    - contextPath: ProofPointTRAP.Incident.events.emails.sender
      description: The sender of the email
      type: String
    - contextPath: ProofPointTRAP.Incident.events.emails.recipient
      description: The recipient of the email
      type: String
    - contextPath: ProofPointTRAP.Incident.events.emails.message_Id
      description: The message ID of the email
      type: String
    - contextPath: ProofPointTRAP.Incident.events.emails.message_delivery_time
      description: The delivery time of the message
      type: Number
    - contextPath: ProofPointTRAP.Incident.events.attackers.location
      description: The location of the attacker
      type: String
    - contextPath: ProofPointTRAP.Incident.events.falsePositive
      description: Weather this incident is a false positive or not
      type: Boolean
    - contextPath: ProofPointTRAP.Incident.events.threatname
      description: The threat name
      type: String
    - contextPath: ProofPointTRAP.Incident.events.description
      description: The description of the event
      type: String
    - contextPath: ProofPointTRAP.Incident.events.malwareName
      description: The malware name
      type: String
    - contextPath: ProofPointTRAP.Incident.quarantine_results.alertSource
      description: The alert source
      type: String
    - contextPath: ProofPointTRAP.Incident.quarantine_results.startTime
      description: The start time of the result
      type: Date
    - contextPath: ProofPointTRAP.Incident.quarantine_results.endTime
      description: The end time of the result
      type: Date
    - contextPath: ProofPointTRAP.Incident.quarantine_results.status
      description: The status of the result
      type: String
    - contextPath: ProofPointTRAP.Incident.quarantine_results.recipientType
      description: The recipient type
      type: String
    - contextPath: ProofPointTRAP.Incident.quarantine_results.recipient
      description: The recipient email address
      type: String
    - contextPath: ProofPointTRAP.Incident.quarantine_results.messageId
      description: The message ID
      type: String
    - contextPath: ProofPointTRAP.Incident.quarantine_results.isRead
      description: Weather the message has been read or not
      type: Boolean
    - contextPath: ProofPointTRAP.Incident.quarantine_results.wasUndone
      description: Weather the message was undone or not
      type: String
    - contextPath: ProofPointTRAP.Incident.quarantine_results.details
      description: The details about the result
      type: String
    - contextPath: ProofPointTRAP.Incident.successful_quarantines
      description: The number of seccessfull quarantines
      type: Number
    - contextPath: ProofPointTRAP.Incident.failed_quarantines
      description: The number of failed quarantines
      type: Number
    - contextPath: ProofPointTRAP.Incident.pending_quarantines
      description: The number of pending quarantines
      type: Number
    - contextPath: ProofPointTRAP.Incident.events.emails.body
      description: The body of the email
      type: String
    - contextPath: ProofPointTRAP.Incident.events.emails.body_type
      description: The format of the body
      type: String
    - contextPath: ProofPointTRAP.Incident.events.emails.headers
      description: The headers of the emails
      type: Unknown
    - contextPath: ProofPointTRAP.Incident.events.emails.urls
      description: Urls list from the email
      type: Unknown
    - contextPath: ProofPoint.Incident.event_ids
      description: List of IDs attached to the incident
      type: Unknown
  - arguments:
    - default: true
      description: The ID value of incident to retrieve
      isArray: false
      name: incident_id
      required: true
      secret: false
    - auto: PREDEFINED
      default: false
      description: ' Setting expand_events to false will return an array of event
        idâ€™s instead of full event objects. This will significantly speed up the response
        time of the API for incidents with large numbers of alerts.'
      isArray: false
      name: expand_events
      predefined:
      - 'true'
      - 'false'
      required: false
      secret: false
    deprecated: false
    description: Retrieve incident metadata from Threat Response.
    execution: false
    name: proofpoint-tr-get-incident
    outputs:
    - contextPath: ProofPointTRAP.Incident.id
      description: The incident ID
      type: Number
    - contextPath: ProofPointTRAP.Incident.summary
      description: The summary of the incident
      type: String
    - contextPath: ProofPointTRAP.Incident.score
      description: The score of the incident from ProofPoint
      type: Number
    - contextPath: ProofPointTRAP.Incident.state
      description: The state of the incident. Can be - Open, Closed, New, Assigned,
        Ignored
      type: String
    - contextPath: ProofPointTRAP.Incident.created_at
      description: The creation time of the incident
      type: Date
    - contextPath: ProofPointTRAP.Incident.updated_at
      description: The update time of the incident
      type: Date
    - contextPath: ProofPointTRAP.Incident.event_count
      description: The number of events attached to the incident
      type: Number
    - contextPath: ProofPointTRAP.Incident.false_positive_count
      description: The number of false positive events in the incident
      type: Number
    - contextPath: ProofPointTRAP.Incident.event_sources
      description: The sources of the events
      type: String
    - contextPath: ProofPointTRAP.Incident.assignee
      description: The user assigned to the incident
      type: String
    - contextPath: ProofPointTRAP.Incident.team
      description: The team assigned to the incident
      type: String
    - contextPath: ProofPointTRAP.Incident.hosts.attacker
      description: The host attacker
      type: String
    - contextPath: ProofPointTRAP.Incident.hosts.forensics
      description: The host forensics
      type: String
    - contextPath: ProofPointTRAP.Incident.incident_field_values.Severity
      description: The severity of the incident
      type: String
    - contextPath: ProofPointTRAP.Incident.incident_field_values.Abuse_disposition
      description: The abuse disposition of the incident
      type: String
    - contextPath: ProofPointTRAP.Incident.incident_field_values.Attack_vector
      description: The attack vector of the incident
      type: String
    - contextPath: ProofPointTRAP.Incident.incident_field_values.Classification
      description: The classification of the incident
      type: String
    - contextPath: ProofPointTRAP.Incident.events.id
      description: The event ID
      type: Number
    - contextPath: ProofPointTRAP.Incident.events.category
      description: The event category
      type: String
    - contextPath: ProofPointTRAP.Incident.events.alertType
      description: The alert type of the event
      type: String
    - contextPath: ProofPointTRAP.Incident.events.severity
      description: The severity of the event
      type: String
    - contextPath: ProofPointTRAP.Incident.events.source
      description: The source of the event
      type: String
    - contextPath: ProofPointTRAP.Incident.events.state
      description: The state of the event
      type: String
    - contextPath: ProofPointTRAP.Incident.events.attackDirection
      description: The attack direction of the event
      type: String
    - contextPath: ProofPointTRAP.Incident.events.received
      description: The time the incident was recieved
      type: Date
    - contextPath: ProofPointTRAP.Incident.events.emails.sender
      description: The sender of the email
      type: String
    - contextPath: ProofPointTRAP.Incident.events.emails.recipient
      description: The recipient of the email
      type: String
    - contextPath: ProofPointTRAP.Incident.events.emails.message_Id
      description: The message ID of the email
      type: String
    - contextPath: ProofPointTRAP.Incident.events.emails.message_delivery_time
      description: The delivery time of the message
      type: Number
    - contextPath: ProofPointTRAP.Incident.events.attackers.location
      description: The location of the attacker
      type: String
    - contextPath: ProofPointTRAP.Incident.events.falsePositive
      description: Weather this incident is a false positive or not
      type: Boolean
    - contextPath: ProofPointTRAP.Incident.events.threatname
      description: The threat name
      type: String
    - contextPath: ProofPointTRAP.Incident.events.description
      description: The description of the event
      type: String
    - contextPath: ProofPointTRAP.Incident.events.malwareName
      description: The malware name
      type: String
    - contextPath: ProofPointTRAP.Incident.quarantine_results.alertSource
      description: The alert source
      type: String
    - contextPath: ProofPointTRAP.Incident.quarantine_results.startTime
      description: The start time of the result
      type: Date
    - contextPath: ProofPointTRAP.Incident.quarantine_results.endTime
      description: The end time of the result
      type: Date
    - contextPath: ProofPointTRAP.Incident.quarantine_results.status
      description: The status of the result
      type: String
    - contextPath: ProofPointTRAP.Incident.quarantine_results.recipientType
      description: The recipient type
      type: String
    - contextPath: ProofPointTRAP.Incident.quarantine_results.recipient
      description: The recipient email address
      type: String
    - contextPath: ProofPointTRAP.Incident.quarantine_results.messageId
      description: The message ID
      type: String
    - contextPath: ProofPointTRAP.Incident.quarantine_results.isRead
      description: Weather the message has been read or not
      type: Boolean
    - contextPath: ProofPointTRAP.Incident.quarantine_results.wasUndone
      description: Weather the message was undone or not
      type: String
    - contextPath: ProofPointTRAP.Incident.quarantine_results.details
      description: The details about the result
      type: String
    - contextPath: ProofPointTRAP.Incident.successful_quarantines
      description: The number of seccessfull quarantines
      type: Number
    - contextPath: ProofPointTRAP.Incident.failed_quarantines
      description: The number of failed quarantines
      type: Number
    - contextPath: ProofPointTRAP.Incident.pending_quarantines
      description: The number of pending quarantines
      type: Number
    - contextPath: ProofPointTRAP.Incident.events.emails.body
      description: The body of the email
      type: String
    - contextPath: ProofPointTRAP.Incident.events.emails.body_type
      description: The format of the body
      type: String
    - contextPath: ProofPointTRAP.Incident.events.emails.headers
      description: The headers of the emails
      type: Unknown
    - contextPath: ProofPointTRAP.Incident.events.emails.urls
      description: Urls list from the email
      type: Unknown
    - contextPath: ProofPoint.Incident.event_ids
      description: List of IDs attached to the incident
      type: Unknown
  - arguments:
    - default: false
      defaultValue: The id value of incident to add the comments.
      description: The ID value of the incident to add the comment to
      isArray: false
      name: incident_id
      required: true
      secret: false
    - default: false
      description: 'The details of the comments '
      isArray: false
      name: details
      required: true
      secret: false
    - default: false
      description: The summary of the comments
      isArray: false
      name: comments
      required: true
      secret: false
    deprecated: false
    description: Add comments to an existing Threat Response incident by incident
      ID.
    execution: false
    name: proofpoint-tr-add-comment-to-incident
    outputs:
    - contextPath: ProofPointTRAP.IncidentComment.id
      description: The ID of the comment
      type: Number
    - contextPath: ProofPointTRAP.IncidentComment.incident_id
      description: The ID of the incident
      type: Number
    - contextPath: ProofPointTRAP.IncidentComment.response_id
      description: The ID of the response
      type: Number
    - contextPath: ProofPointTRAP.IncidentComment.user_id
      description: The ID of the User
      type: String
    - contextPath: ProofPointTRAP.IncidentComment.history_type
      description: The hisroty type
      type: String
    - contextPath: ProofPointTRAP.IncidentComment.state_from
      description: The state from of the incident
      type: String
    - contextPath: ProofPointTRAP.IncidentComment.state_to
      description: The state to of the incident
      type: String
    - contextPath: ProofPointTRAP.IncidentComment.summary
      description: The summary of the comments
      type: String
    - contextPath: ProofPointTRAP.IncidentComment.detail
      description: The details of the comment
      type: String
    - contextPath: ProofPointTRAP.IncidentComment.created_at
      description: The creation time of the incident
      type: Date
    - contextPath: ProofPointTRAP.IncidentComment.updated_at
      description: The update time of the incident
      type: Date
  - arguments:
    - default: false
      description: The ID value of the incident to add the user to
      isArray: false
      name: incident_id
      required: true
      secret: false
    - default: false
      description: List of targets to add to an incident
      isArray: true
      name: targets
      required: true
      secret: false
    - default: false
      description: List of attackers to add to an incident
      isArray: true
      name: attackers
      required: true
      secret: false
    deprecated: false
    description: Assign a user to an incident as a target or attacker.
    execution: false
    name: proofpoint-tr-add-user-to-incident
  feed: false
  isfetch: true
  longRunning: false
  longRunningPort: false
  runonce: false
  script: '-'
  subtype: python3
  type: python
tests:
- No test - beta_integration
beta: true
